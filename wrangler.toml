name = "openshortlink"
main = "src/index.ts"
compatibility_date = "2025-12-28"
compatibility_flags = ["nodejs_compat"]
workers_dev = true

# Custom Domain Routes
[[routes]]
pattern = "cjcjr.com/dashboard/*"
zone_name = "cjcjr.com"

[[routes]]
pattern = "cjcjr.com/go/*"
zone_name = "cjcjr.com"

# D1 Database
[[d1_databases]]
binding = "DB"
database_name = "openshortlink-db"
database_id = "ca2517c0-c08a-459a-ab47-2703bc895adc"

# KV Namespace
[[kv_namespaces]]
binding = "CACHE"
id = "182dadafa22847df8cdff1656e503c91"

# Analytics Engine
[[analytics_engine_datasets]]
binding = "ANALYTICS"
dataset = "openshortlink-analytics"

# Environment variables
[vars]
ENVIRONMENT = "production"
LOG_LEVEL = "info"
CACHE_TTL = "604800"
MAX_LINKS_PER_DOMAIN = "10000"

# Cron triggers for scheduled tasks
[triggers]
crons = ["0 0 * * *", "0 */6 * * *"]

[observability]
enabled = false
head_sampling_rate = 1

[observability.logs]
enabled = true
head_sampling_rate = 1
invocation_logs = true

[placement]
mode = "smart"